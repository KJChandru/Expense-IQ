<div *ngIf="isOpen" class="fixed inset-0 bg-black/30 flex items-center justify-center z-50">
  <div class="bg-white rounded-2xl shadow-xl w-full max-w-lg p-6 relative">

    <!-- Close Button -->
    <button (click)="close()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 transition">
      <span class="material-icons">close</span>
    </button>

    <!-- Header -->
    <div class="mb-6">
      <h2 class="text-xl font-semibold text-gray-900">Create Wallet</h2>
      <p class="text-sm text-gray-500">Fill in wallet details</p>
    </div>

    <!-- Form -->
    <form [formGroup]="walletFrom" (ngSubmit)="submitWallet()" class="grid grid-cols-1 gap-4">

      <!-- Wallet Name -->
      <div class="flex flex-col">
        <label class="text-gray-700 font-medium mb-1">Wallet Name <span class="text-red-500">*</span></label>
        <input type="text" formControlName="walletName" placeholder="e.g., Main Bank"
               class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none transition" />
        <small class="text-red-600 mt-1 text-sm" *ngIf="f['walletName'].touched && f['walletName'].invalid">
          Wallet name is required
        </small>
      </div>

      <!-- Description -->
      <div class="flex flex-col">
        <label class="text-gray-700 font-medium mb-1">Description</label>
        <input type="text" formControlName="walletDesc" placeholder="Optional description"
               class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none transition">
      </div>

      <!-- Wallet Type -->
      <div class="flex flex-col">
        <label class="text-gray-700 font-medium mb-1">Wallet Type <span class="text-red-500">*</span></label>
        <div class="flex gap-2 flex-wrap mt-1">
          <button
            *ngFor="let type of walletDetails"
            type="button"
            class="px-3 py-2 rounded-xl text-sm font-medium transition-all duration-150 border"
            [ngClass]="{
              'bg-blue-600 text-white border-blue-600 shadow': walletFrom.value.walletType === type.walletTypeid && type.typeDesc==='Bank',
              'bg-green-600 text-white border-green-600 shadow': walletFrom.value.walletType === type.walletTypeid && type.typeDesc==='Cash',
              'bg-orange-500 text-white border-orange-500 shadow': walletFrom.value.walletType === type.walletTypeid && type.typeDesc==='Card',
              'bg-gray-50 text-gray-700 border-gray-300 hover:bg-gray-100': walletFrom.value.walletType !== type.walletTypeid
            }"
            (click)="walletFrom.get('walletType')?.setValue(type.walletTypeid)">
            {{ type.typeDesc }}
          </button>
        </div>
        <small class="text-red-600 mt-1 text-sm" *ngIf="f['walletType'].touched && f['walletType'].invalid">
          Wallet type is required
        </small>
      </div>

      <!-- Currency -->
      <div class="flex flex-col">
        <label class="text-gray-700 font-medium mb-1">Currency <span class="text-red-500">*</span></label>
        <div class="relative mt-1">
          <select formControlName="currency"
                  class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none transition appearance-none text-gray-900 bg-white">
            <option value="">Select currency</option>
            <option *ngFor="let currency of currencyDetails" [value]="currency.currencyId">
              {{currency.currencyCode}}
            </option>
          </select>
          <span class="material-icons absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none">
            expand_more
          </span>
        </div>
        <small class="text-red-600 mt-1 text-sm" *ngIf="f['currency'].touched && f['currency'].invalid">
          Currency is required
        </small>
      </div>

      <!-- Credit Amount -->
      <div class="flex flex-col">
        <label class="text-gray-700 font-medium mb-1">Credit Amount <span class="text-red-500">*</span></label>
        <input type="number" formControlName="initalCreditedAmt" placeholder="0.00"
               class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none transition">
        <small class="text-red-600 mt-1 text-sm" *ngIf="f['initalCreditedAmt'].touched && f['initalCreditedAmt'].invalid">
          Credit amount is required and must be positive
        </small>
      </div>

      <!-- Submit Button -->
      <button type="submit"
              [disabled]="walletFrom.invalid"
              [ngClass]="walletFrom.invalid
                ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
                : 'bg-black text-white hover:bg-gray-900 shadow-md'"
              class="w-full py-3 font-semibold rounded-xl transition">
        Create Wallet
      </button>

    </form>
  </div>
</div>
